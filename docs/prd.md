# プロダクト要件定義書（PRD）— MVP

## 概要

GitHub Issue をタスクキューとして活用し、ラベル付与をトリガーに Claude Code が自律的に実装・テスト・PR 作成を行うシステム。人間のレビューと Claude の実装が非同期で並走することで、開発サイクルを加速する。

## 背景

ソフトウェア開発において、人間のレビューや指示出しが実装のボトルネックになることが多い。特に小〜中規模の機能追加やバグ修正では、実装自体よりも「人間がタスクを拾い上げて指示する」フェーズに時間がかかることが課題である。

GitHub の Issue や PR という既存のインターフェースを活用しつつ、Claude Code が自律的に実装を担うことで、人間は「要件定義」と「レビュー」という高レベルな作業に集中できる環境を実現する。

## プロダクト・プリンシプル

1. **GitHub ネイティブ**: 既存の GitHub フローを壊さず、Issue・PR・コメントをそのまま使う
2. **非同期並走**: 人間のレビューと Claude の実装が並走し、互いを待たせない
3. **透明性**: Claude が行った実装・判断はすべて PR や Issue コメントで人間が確認できる
4. **最小権限**: Claude は必要最小限の操作のみ行い、main ブランチへの直接プッシュはしない
5. **既存ツールの活用**: `.claude/` 配下のスキル・エージェント・ルールを活用し、一貫したワークフローを維持する

## スコープ

### 含むもの

- Issue への `claude:implement` ラベル付与による自律実装トリガー
- Issue を元にしたブランチ自動作成（`issue-{number}`）
- Claude Code による実装・テスト作成
- 実装完了後の PR 自動作成（`Closes #{number}` 付き）
- PR コメントへの `@claude` メンションによる修正対応
- 不明点がある場合の Issue へのコメント質問と `claude:waiting` ラベル付与

### 含まないもの

- 自動マージ（マージは人間が行う）
- CI/CD パイプラインの管理（GitHub Actions の定義のみ提供）
- コードレビューの自動承認
- 複数 Issue の並列実装（同時実行は考慮しない）

## 対象ユーザー

### ペルソナ: 個人開発者・小規模チーム

- GitHub を日常的に使っている開発者
- AI を活用して開発速度を上げたい
- コードの品質は自分でレビューしたい（完全な自動化は求めない）
- セットアップの複雑さを避けたい（シンプルに使いたい）

## ユースケース

### UC-1: 機能実装を Claude に依頼する

1. 開発者が GitHub Issue に実装したい機能を記載する
2. Issue に `claude:implement` ラベルを付与する
3. GitHub Actions が起動し、Claude Code が実装を開始する
4. Claude Code がブランチを作成し、実装・テストを行い、PR を作成する
5. 開発者が PR をレビューし、問題なければマージする

### UC-2: PR レビュー中に修正指示を出す

1. 開発者が PR レビュー中に修正が必要な点を発見する
2. PR コメントで `@claude` をメンションして修正内容を記載する
3. Claude Code が修正を行い、コミットをプッシュする

### UC-3: 不明点がある場合に質問する

1. Claude Code が Issue の内容から実装方針を決めようとするが、不明点がある
2. Claude Code が Issue にコメントで質問を投稿する
3. Issue に `claude:waiting` ラベルが付与される
4. 開発者が質問に回答する
5. 開発者が `claude:implement` ラベルを再付与して実装を再開する

## 機能要求

### F-1: Issue ラベルトリガー

- `claude:implement` ラベルが付与されると GitHub Actions ワークフローが起動する
- ワークフローは Claude Code Action を使って Claude Code を実行する

### F-2: ブランチ管理

- `issue-{number}` 形式のブランチを自動作成する
- main ブランチへの直接コミットは行わない

### F-3: 自律実装

- Issue の内容（タイトル・本文）を読んで実装方針を決定する
- `.claude/` 配下のスキル・エージェント・ルールに従って実装する
- テストを作成し、通過することを確認してから PR を作成する

### F-4: PR 作成

- 実装完了後に PR を自動作成する
- PR 本文に Summary・変更点・テスト・確認事項を含める
- `Closes #{issue_number}` で Issue と紐付ける

### F-5: PR レビュー対応

- PR コメントで `@claude` がメンションされると修正対応を行う
- 修正後は同じブランチにコミットをプッシュする

### F-6: 質問・待機

- 不明点が多い場合は Issue にコメントで質問する
- `claude:waiting` ラベルを付与して待機状態を明示する

## UX要求

### UX-1: GitHub ネイティブなインターフェース

- ラベル操作・コメント記述という既存の GitHub 操作のみで Claude を制御できる
- 専用 UI や追加ツールのインストールは不要

### UX-2: 進捗の可視性

- Claude の作業状況は Issue コメントや PR で随時確認できる
- 何を実装したか・何を判断したかが PR に記載される

### UX-3: 人間が最終判断者

- コードのマージは必ず人間が行う
- Claude の実装内容に問題があれば PR でフィードバックできる

## システム要求

### SR-1: GitHub Actions

- GitHub Actions ワークフローで Claude Code Action を実行する
- 必要な権限: `contents: write`（ブランチ・コミット操作）、`pull-requests: write`（PR 作成）、`issues: write`（コメント・ラベル操作）、`id-token: write`（認証）

### SR-2: 認証

- `ANTHROPIC_API_KEY` シークレットで Claude API に認証する

### SR-3: 実行環境

- Node.js 22 環境で動作する
- `.claude/` 配下のスキル・エージェント・ルールを読み込む

### SR-4: ブランチ保護

- main ブランチへの直接コミットを行わない（ワークフロールール）

## マイルストーン

| マイルストーン | 内容 | 目標時期 |
|-------------|------|---------|
| M1: MVP完成 | Issue ラベルトリガーによる自律実装・PR 作成の基本フロー | 2026-02 |
| M2: 品質向上 | テスト自動化・Lint 統合・コードレビュー機能強化 | 2026-03 |
| M3: ワークフロー拡充 | 並列実装対応・ラベル管理自動化・ダッシュボード | 2026-Q2 |
