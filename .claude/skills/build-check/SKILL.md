---
name: build-check
description: "ビルドとLintチェックを実行し、結果サマリーを返す。ビルドログはフォークコンテキスト内に閉じ込め、メインコンテキストにはサマリーのみ返却する。"
user_invocable: true
context: fork
allowed-tools: Bash, Read
---

# ビルド・Lint チェック

以下の手順でビルドとLintチェックを実行し、結果のサマリーのみを出力せよ。

> **注意**: Bash ツールで `run_in_background` を使ってはいけない。
> コマンドは直接実行（フォアグラウンド）し、`timeout 120` でタイムアウトを設定すること。
> ps や grep でプロセスを確認する手順は不要。

## 1. package.json の確認

プロジェクトルートの `package.json` を Read で読み込み、`scripts` セクションから以下を確認する:

- `build` スクリプトの有無
- `lint` スクリプトの有無

いずれも存在しない場合は「チェック対象のスクリプトがありません」と報告して終了する。

## 2. ビルド実行

`build` スクリプトが存在する場合、`timeout 300 npm run build` を実行する。

- 成功した場合: ビルド成功と記録する
- 失敗した場合: エラー出力から **ファイル名・行番号・エラーメッセージ** のみを抽出する

## 3. Lint 実行

`lint` スクリプトが存在する場合、`timeout 300 npm run lint` を実行する。

- 成功した場合: Lint成功と記録する
- 失敗した場合: エラー出力から **ファイル名・行番号・エラーメッセージ** のみを抽出する

## 4. サマリー出力

以下のフォーマットで結果を出力する。ビルドログの全文は出力しないこと。

```
## ビルド・Lint チェック結果

- ビルド: ✅ 成功 / ❌ 失敗
- Lint: ✅ 成功 / ❌ 失敗

### エラー詳細（失敗時のみ）
- `ファイル名:行番号` — エラーメッセージ
- `ファイル名:行番号` — エラーメッセージ
```
