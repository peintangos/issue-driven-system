---
name: req-update
description: "要件変更・追加の影響を分析し、全ドキュメントの更新案をレポートする。メインコンテキストにはサマリーのみ返却する。"
argument-hint: "[変更・追加内容の説明]"
user-invocable: true
context: fork
allowed-tools: Read, Glob, Grep
---

# 要件変更・追加 影響分析

`$ARGUMENTS` の内容に基づき、要件変更・追加の影響を分析し、全ドキュメントの更新案をレポートする。

## 1. 全ドキュメント読み込み

以下を全て Read で読み込む:

- `docs/prd.md` および `docs/prd-enhance-*.md`（Glob で検索）
- `docs/specifications/` 配下の全ファイル（Glob で検索）
- `docs/progress.md`
- `docs/roadmap.md`
- `docs/todo/todo.md`（存在する場合）
- `docs/architecture/architecture.md`

## 2. コードベース調査

`$ARGUMENTS` のキーワードに関連するコードを調査する:

- Grep で関連するコードを検索する
- Glob で関連するファイルを特定する
- 影響を受ける実装ファイルを一覧化する

## 3. 影響分析

`$ARGUMENTS` の内容を解釈し、以下を判定する:

- **変更種別**: 要件変更 / 要件追加 / 両方
- **影響するドキュメント**: PRD / specifications / progress / roadmap / todo / architecture のどれか
- **影響するコード**: 既存実装への影響があるか

## 4. 各ドキュメントの更新案ドラフト

影響があるドキュメントごとに、具体的な更新内容を記述する:

- **PRD**: 機能要求テーブルの行追加/変更、スコープの更新など
- **Specifications**: シナリオの追加/変更、受入条件の更新、実装ステップの追加/変更
- **Progress**: 新specの行追加、ステータス変更
- **Roadmap**: マイルストーン内容の更新、依存関係の変更
- **TODO**: タスクの追加/変更/削除
- **Architecture**: データモデル変更など（該当時のみ）

更新案は「既存テキストの何を→何に変えるか」または「何を追記するか」を明確に記述すること。

## 5. レポート出力

以下の構造化フォーマットで出力する。これがメインコンテキストに返却されるサマリーとなる。

```
## 要件更新 影響分析レポート

### 変更概要
- 種別: 要件変更 / 要件追加
- 内容: [概要]

### 影響範囲サマリー

| ドキュメント | 影響 | 変更概要 |
|------------|------|---------|
| PRD | ✏️ 変更あり / ➕ 追加あり / — なし | [概要] |
| Specification | ... | ... |
| Progress | ... | ... |
| Roadmap | ... | ... |
| TODO | ... | ... |
| Architecture | ... | ... |

### コードへの影響
- [ファイルパス]: [影響概要]
（未実装の場合は「該当コードなし」）

### 各ドキュメントの更新案

#### PRD (`docs/prd.md`)
[具体的な更新内容。既存テキストの何を→何に変えるか、または追記内容]

#### Specification (`docs/specifications/YYYY-MM-DD-slug.md`)
[具体的な更新内容]

...（影響があるドキュメントごとに記載）

### TODO への影響
- [追加/変更/削除すべきタスク]

### 注意事項
- [更新時に注意すべき点、整合性の観点など]
```

## 注意事項

- 日本語で記述する
- 推測で更新案を作らず、既存ドキュメントの記述を正確に引用した上で変更案を提示する
- 影響がないドキュメントについては「影響なし」と明記し、無理に更新案を作らない
- 更新案はあくまで案であり、メインコンテキストでユーザー承認後に適用される
- このスキルではソースコードの実装・変更は行わない。ドキュメントの更新のみに留める
