---
name: code-review
description: "コードレビューを実施する。変更内容を7観点で分析し結果を提示する。"
user_invocable: true
context: fork
agent: code-reviewer
---

# コードレビュー

以下の手順でコードレビューを実施せよ。

## 1. 変更範囲の特定

```bash
git diff --name-only HEAD
git diff --name-only
git diff --name-only --cached
```

上記のコマンドを実行し、変更されたファイル一覧を取得する。未追跡ファイルも `git status` で確認する。

## 2. プロジェクトルールの読み込み

`.claude/rules/` 配下のすべてのルールファイルを Read で読み込み、プロジェクト規約を把握する。

## 3. 対象 Specification の特定

`steering/` 配下の最新ディレクトリの `plan.md` を Read で確認し、対象 specification のパスを特定する。specification が見つかった場合は Read で読み込み、受入条件を把握する。見つからない場合はスキップする。

## 4. レビュー実施

変更されたファイルを Read で読み込み、以下の7観点でレビューする:

1. **正確性**: ロジックにバグや誤りがないか
2. **セキュリティ**: XSS、SQLインジェクション等の脆弱性がないか
3. **パフォーマンス**: 非効率な処理、N+1クエリ等がないか
4. **可読性**: 命名、構造、コメントが適切か
5. **規約準拠**: プロジェクトルール（`.claude/rules/`）に準拠しているか
6. **仕様準拠**: specification の受入条件を満たしているか（specificationがある場合）
7. **テスト**: テストの網羅性、品質は十分か（テストがある場合）

## 5. レビュー結果レポート

以下のフォーマットで結果を出力する:

```
## コードレビュー結果

**総合判定**: ✅ 問題なし / ⚠️ 要修正

### 指摘事項

#### 🔴 要修正（Must Fix）
- [ファイル:行番号] 説明

#### 🟡 推奨（Should Fix）
- [ファイル:行番号] 説明

#### 🔵 提案（Nice to Have）
- [ファイル:行番号] 説明

### 仕様準拠チェック
- [ ] 受入条件1: ✅ / ❌
- [ ] 受入条件2: ✅ / ❌
```
